#%%
import numpy as np

def get_projections_cosine(user_embedding, matched_embedding):
    user_vec = np.asarray(user_embedding)
    match_vec = np.asarray(matched_embedding)

    user_vec = user_vec / np.linalg.norm(user_vec)
    match_vec = match_vec / np.linalg.norm(match_vec)

    cos_sim = np.dot(user_vec, match_vec)
    angle_deg = np.degrees(np.arccos(np.clip(cos_sim, -1.0, 1.0)))

    # Basis aligned with user_vec
    x_axis = user_vec
    y_axis = np.random.randn(*x_axis.shape)
    y_axis -= np.dot(y_axis, x_axis) * x_axis
    y_axis /= np.linalg.norm(y_axis)

    user_proj = np.array([np.dot(user_vec, x_axis), np.dot(user_vec, y_axis)])
    match_proj = np.array([np.dot(match_vec, x_axis), np.dot(match_vec, y_axis)])

    angle_rad = np.radians(angle_deg)
    rotation_matrix = np.array([
        [np.cos(angle_rad), -np.sin(angle_rad)],
        [np.sin(angle_rad),  np.cos(angle_rad)]
    ])
    rotated_vec = rotation_matrix @ user_proj
    rotated_vec = rotated_vec / np.linalg.norm(rotated_vec) * np.linalg.norm(match_proj)

    return {
        "user_proj": user_proj.tolist(),
        "match_proj": match_proj.tolist(),
        "rotated_vec": rotated_vec.tolist(),
        "cos_sim": float(cos_sim),
        "angle_deg": float(angle_deg)
    }

print(get_projections_cosine(
[
    0.04240438714623451,
    0.08744266629219055,
    -0.023802556097507477,
    -0.016075918450951576,
    -0.16664724051952362,
    0.04275647550821304,
    0.1473986655473709,
    0.0665772557258606,
    0.02157038077712059,
    -0.055349402129650116,
    0.02730623632669449,
    -0.048701439052820206,
    0.015198751352727413,
    -0.023807838559150696,
    -0.028474239632487297,
    0.01992393098771572,
    -0.04611925408244133,
    -0.047838304191827774,
    -0.09889518469572067,
    -0.06327950954437256,
    -0.0018107532523572445,
    0.033224623650312424,
    -0.05430137366056442,
    0.02721148170530796,
    0.02891811542212963,
    0.05169698968529701,
    -0.018772995099425316,
    0.045449040830135345,
    0.048767175525426865,
    -0.03567370027303696,
    0.013105513527989388,
    -0.040615759789943695,
    0.050657182931900024,
    -0.004559451714158058,
    -0.0025622635148465633,
    0.03392472118139267,
    -0.08652586489915848,
    -0.02009226568043232,
    0.030838165432214737,
    -0.00010090414434671402,
    -0.025124268606305122,
    -0.1094924733042717,
    -0.0015939268050715327,
    0.01004526112228632,
    -0.015325401909649372,
    0.019454961642622948,
    -0.02492390386760235,
    0.07296502590179443,
    0.032230425626039505,
    -0.02991577237844467,
    0.0392092764377594,
    -0.05974748358130455,
    -0.08395788818597794,
    0.0027713708113878965,
    0.04552564024925232,
    0.04755769297480583,
    0.01398695632815361,
    0.0451691597700119,
    0.00997590646147728,
    0.02450421079993248,
    0.027806777507066727,
    -0.011337419040501118,
    -0.048058949410915375,
    0.024236951023340225,
    0.03628170117735863,
    -0.0568375289440155,
    0.03408422693610191,
    -0.011268248781561852,
    -0.04815526306629181,
    -0.04155493527650833,
    -0.03455387055873871,
    0.038308706134557724,
    -0.013503829017281532,
    0.09394858032464981,
    0.009942951612174511,
    0.009857725352048874,
    0.026507804170250893,
    -0.05604187771677971,
    0.12046144902706146,
    0.06611190736293793,
    -0.004236788954585791,
    -0.07524193078279495,
    -0.019593331962823868,
    0.04483906179666519,
    -0.0004949400899931788,
    0.04035593196749687,
    -0.019720429554581642,
    0.08981695771217346,
    -0.019750220701098442,
    0.009842755272984505,
    -0.03511498123407364,
    -0.05753352493047714,
    0.055675383657217026,
    -0.026997121050953865,
    -0.061080578714609146,
    0.03637690842151642,
    -0.045110806822776794,
    -0.047434002161026,
    -0.05563279241323471,
    0.20118951797485352,
    -0.0026269848458468914,
    0.011122239753603935,
    0.0859861746430397,
    -0.0019612701144069433,
    -0.07940463721752167,
    0.013762443326413631,
    0.027504337951540947,
    -0.019106434658169746,
    0.05658256262540817,
    -0.05290169268846512,
    -0.028379177674651146,
    -0.007141464855521917,
    -0.0027295160107314587,
    0.0038808267563581467,
    -0.04310726001858711,
    -0.053314536809921265,
    0.004853683058172464,
    0.01700240932404995,
    0.026844078674912453,
    0.07009439170360565,
    0.0390753336250782,
    -0.0487312413752079,
    -0.08236619830131531,
    0.0064135328866541386,
    -0.11345607042312622,
    -0.03931738808751106,
    0.045810069888830185,
    -4.4360328266751464e-33,
    -0.0030483321752399206,
    0.03888147696852684,
    0.03598436713218689,
    -0.04643162712454796,
    -0.015080119483172894,
    -0.014832964166998863,
    -0.08468126505613327,
    0.055881865322589874,
    -0.015728997066617012,
    0.006570182275027037,
    -0.028639135882258415,
    -0.039775967597961426,
    0.045344676822423935,
    -0.07065572589635849,
    0.062251415103673935,
    -0.07123397290706635,
    0.08931879699230194,
    0.030225275084376335,
    -0.015391776338219643,
    -0.031103059649467468,
    -0.05965298041701317,
    0.09098484367132187,
    0.04718483239412308,
    -0.039732806384563446,
    -0.03329118713736534,
    -0.04687971994280815,
    0.013752267695963383,
    -0.08410053700208664,
    0.033902671188116074,
    0.0015482649905607104,
    0.007306260522454977,
    -0.0974607765674591,
    -0.007632534019649029,
    0.0212466549128294,
    0.04311192408204079,
    0.0015566801885142922,
    0.03715295344591141,
    -0.025518111884593964,
    0.020336568355560303,
    0.008916279301047325,
    -0.04192933440208435,
    -0.06567537039518356,
    0.07966875284910202,
    0.049915410578250885,
    0.04676821082830429,
    0.011441350914537907,
    0.014373602345585823,
    0.003080262802541256,
    -0.07897771149873734,
    -0.007257051300257444,
    0.04537101089954376,
    0.02398749627172947,
    -0.05545414239168167,
    0.08159654587507248,
    -0.007767656818032265,
    -0.01504953857511282,
    0.01581551693379879,
    -0.021777460351586342,
    -0.06380201131105423,
    0.036804478615522385,
    -0.02892393246293068,
    0.09614159166812897,
    0.0797547996044159,
    0.055297236889600754,
    0.008009213022887707,
    -0.027178585529327393,
    0.05490495637059212,
    -0.0857788547873497,
    0.02971482276916504,
    0.03191075474023819,
    -0.12435153126716614,
    -0.029055895283818245,
    -0.01678232103586197,
    -0.01432610023766756,
    -0.08672967553138733,
    -0.018796037882566452,
    -0.0023818928748369217,
    -0.02719697169959545,
    -0.023728324100375175,
    -0.022877834737300873,
    -0.0960826501250267,
    -0.05513237416744232,
    -0.004833071492612362,
    0.051984529942274094,
    -0.01758021116256714,
    0.008856164291501045,
    -0.0023399097844958305,
    -0.13080795109272003,
    0.06506799161434174,
    -0.03070761449635029,
    -0.07148270308971405,
    -0.06890308856964111,
    -0.04337620362639427,
    -0.015080028213560581,
    0.07062292844057083,
    2.501689832484877e-33,
    0.03920311853289604,
    0.03364228457212448,
    -0.05165433511137962,
    0.04000097140669823,
    0.06737278401851654,
    0.003042267868295312,
    0.06258510053157806,
    0.019136110320687294,
    -0.06214000657200813,
    -0.0069547793827950954,
    -0.01518816314637661,
    0.02691047638654709,
    0.02171986550092697,
    -0.005364419426769018,
    0.07425002753734589,
    0.03970255330204964,
    0.005489903502166271,
    0.05148857831954956,
    0.04102367162704468,
    -0.012727851048111916,
    -0.03934604302048683,
    -0.020254865288734436,
    -0.027064811438322067,
    -0.02156747691333294,
    -0.004117259290069342,
    0.05325546860694885,
    0.0782138779759407,
    -0.059986960142850876,
    0.01780165731906891,
    0.05248008295893669,
    -0.04710691049695015,
    -0.0470108762383461,
    0.07654418796300888,
    0.041227810084819794,
    -0.12010546028614044,
    0.06864438951015472,
    0.16553042829036713,
    0.010471144691109657,
    0.024172356352210045,
    -0.014566291123628616,
    0.07887468487024307,
    0.0785907432436943,
    0.05868219584226608,
    0.1006762832403183,
    -0.02087046205997467,
    -0.008189547806978226,
    -0.055096495896577835,
    0.037065934389829636,
    -0.00731476629152894,
    0.0029683979228138924,
    0.020431485027074814,
    -0.03513976186513901,
    -0.016876613721251488,
    -0.044617895036935806,
    -0.0191781185567379,
    0.026030879467725754,
    -0.09984594583511353,
    0.002309792675077915,
    -0.04870738089084625,
    0.023554092273116112,
    -0.09303838014602661,
    0.0034592754673212767,
    0.04633172228932381,
    0.01399100199341774,
    0.016214650124311447,
    -0.00038133354973979294,
    -0.0380379818379879,
    -0.02965148352086544,
    -0.05040493607521057,
    -0.10195929557085037,
    0.024997714906930923,
    0.014434930868446827,
    -0.08271868526935577,
    0.024557899683713913,
    -0.05795520171523094,
    0.010566557757556438,
    -0.06094151735305786,
    0.03953775763511658,
    -0.024169551208615303,
    0.08722368627786636,
    0.038775548338890076,
    0.041772160679101944,
    -0.019756754860281944,
    0.0368586890399456,
    0.033436816185712814,
    -0.06339845061302185,
    0.03482496738433838,
    0.055956218391656876,
    -0.04094640165567398,
    -0.010175839066505432,
    0.04539818689227104,
    0.12253397703170776,
    -0.03019634447991848,
    0.03306923806667328,
    -0.034084878861904144,
    -1.1778297448472586e-8,
    -0.0036352418828755617,
    0.025681311264634132,
    -0.033861491829156876,
    0.0015316765056923032,
    0.07500451803207397,
    0.07352599501609802,
    -0.04737166315317154,
    -0.09122545272111893,
    0.02449142187833786,
    0.02272406779229641,
    0.018415076658129692,
    -0.019424322992563248,
    -0.06391686201095581,
    -0.03060772269964218,
    0.012998831458389759,
    -0.009283631108701229,
    -0.03095262311398983,
    -0.03408049792051315,
    -0.03250716254115105,
    0.04043913632631302,
    0.020925216376781464,
    0.0006358969840221107,
    -0.09207236021757126,
    -0.02530232071876526,
    -0.03716491907835007,
    0.00021881259453948587,
    -0.046926915645599365,
    0.07102521508932114,
    0.02446809411048889,
    0.08588846027851105,
    0.09095774590969086,
    0.08903853595256805,
    -0.021884609013795853,
    -0.0658692792057991,
    -0.08354409784078598,
    0.019098911434412003,
    -0.016708219423890114,
    -0.006484383251518011,
    0.06199570745229721,
    0.04940197989344597,
    0.08490226417779922,
    0.08512349426746368,
    -0.03597961366176605,
    0.021508516743779182,
    -0.01240522786974907,
    -0.08387026935815811,
    0.053419582545757294,
    -0.0770421177148819,
    -0.025708472356200218,
    -0.029274994507431984,
    -0.02153456211090088,
    0.014335176907479763,
    0.04884463548660278,
    0.006973398383706808,
    -0.014841544441878796,
    0.006119570229202509,
    0.0054090493358671665,
    0.016820771619677544,
    -0.10914488136768341,
    0.0705156922340393,
    0.023921694606542587,
    -0.006671820767223835,
    0.08475527167320251,
    -0.02067498117685318
  ],
 [
    -0.09047620743513107,
    0.040439557284116745,
    0.02390570193529129,
    0.05894792452454567,
    -0.02288236655294895,
    -0.04722001031041145,
    0.04504762217402458,
    0.015786366537213326,
    -0.04819956794381142,
    -0.03779410570859909,
    -0.019077617675065994,
    0.021308720111846924,
    -0.004683023784309626,
    -0.04330819100141525,
    0.05991470813751221,
    0.059103354811668396,
    -0.028036806732416153,
    -0.05921834334731102,
    -0.124403215944767,
    -0.035599932074546814,
    -0.0060805645771324635,
    0.03242900222539902,
    -0.03780078515410423,
    0.024710936471819878,
    -0.04272444173693657,
    -0.04245385155081749,
    0.04593557491898537,
    0.0986255407333374,
    -0.04999799653887749,
    -0.03523583337664604,
    0.07083980739116669,
    0.033163294196128845,
    0.026588324457406998,
    0.00017320274491794407,
    0.003881629789248109,
    0.030467214062809944,
    -0.07820264250040054,
    -0.12037955224514008,
    0.018041566014289856,
    0.022829080000519753,
    -0.0017750462284311652,
    -0.02344989962875843,
    0.0030581350438296795,
    0.024355653673410416,
    0.04415398836135864,
    -0.04010975360870361,
    0.020192347466945648,
    0.010888109914958477,
    0.02873148024082184,
    0.012367765419185162,
    -0.09131912887096405,
    -0.06812441349029541,
    0.006191501393914223,
    -0.012560480274260044,
    0.09282492101192474,
    0.027907051146030426,
    -0.031219767406582832,
    -0.02523522637784481,
    0.07843621075153351,
    -0.07330272346735,
    -0.06698232144117355,
    0.013900204561650753,
    -0.14281445741653442,
    0.008772104978561401,
    0.020701073110103607,
    0.00009077757567865774,
    -0.059135802090168,
    -0.06520269811153412,
    -0.03802470862865448,
    -0.06197245419025421,
    -0.002507086144760251,
    -0.004245085641741753,
    -0.04136200249195099,
    -0.04957136511802673,
    0.022460106760263443,
    -0.03562810644507408,
    0.0403861403465271,
    0.048840999603271484,
    0.05201952904462814,
    0.03164215013384819,
    0.030273091048002243,
    -0.03808005526661873,
    -0.016518553718924522,
    -0.00683419406414032,
    -0.008964934386312962,
    -0.038086116313934326,
    0.023735256865620613,
    -0.008561244234442711,
    -0.05127958208322525,
    0.010258369147777557,
    -0.10671523213386536,
    0.053877536207437515,
    0.030373787507414818,
    -0.035446617752313614,
    -0.07692984491586685,
    -0.06118857115507126,
    0.07783690840005875,
    0.0010847505182027817,
    -0.12356828153133392,
    0.2791738212108612,
    0.04799335077404976,
    0.05214143916964531,
    0.04218771308660507,
    0.10217690467834473,
    -0.021179324015975,
    0.053146764636039734,
    -0.05259433388710022,
    0.07748840004205704,
    -0.005982271861284971,
    0.02233404479920864,
    0.02564449980854988,
    -0.0017713340930640697,
    -0.027925437316298485,
    -0.019152510911226273,
    0.05490529537200928,
    0.07075369358062744,
    -0.0033721572253853083,
    0.007494335528463125,
    0.025769537314772606,
    -0.07102818042039871,
    -0.024785347282886505,
    -0.053852759301662445,
    0.03375687822699547,
    -0.04508248344063759,
    -0.01983441226184368,
    -0.02400762215256691,
    0.003078347072005272,
    -4.3980515021741244e-33,
    0.07137409597635269,
    -0.024629149585962296,
    0.043476566672325134,
    0.08482524752616882,
    -0.04635673761367798,
    -0.034102343022823334,
    -0.02294209972023964,
    -0.04998016729950905,
    0.0020604704041033983,
    0.005182716995477676,
    0.00805833749473095,
    0.005911195185035467,
    -0.04033646732568741,
    -0.0023422958329319954,
    -0.025733688846230507,
    0.03138197585940361,
    0.04917076602578163,
    0.05957555025815964,
    0.03628140315413475,
    0.0359637513756752,
    -0.0795033648610115,
    -0.031889658421278,
    0.020353998988866806,
    0.05408875644207001,
    0.03402204066514969,
    -0.02667994238436222,
    0.0051358360797166824,
    -0.13762329518795013,
    0.053568143397569656,
    0.06246081367135048,
    0.046655505895614624,
    0.00825155433267355,
    -0.0011227340437471867,
    0.015864279121160507,
    -0.014868666417896748,
    -0.01065458357334137,
    0.013925153762102127,
    -0.05111163109540939,
    -0.051157012581825256,
    0.018110405653715134,
    -0.02603183127939701,
    0.04104926064610481,
    0.06183970719575882,
    -0.04096408188343048,
    0.02030029334127903,
    0.04352159798145294,
    0.015208630822598934,
    0.02213992364704609,
    0.005854356102645397,
    0.03384196385741234,
    -0.05831827223300934,
    0.004042369779199362,
    -0.13897085189819336,
    0.0042135752737522125,
    -0.005619977135211229,
    -0.04354964569211006,
    -0.005907115992158651,
    -0.07454471290111542,
    0.08359625190496445,
    0.040250442922115326,
    0.03140870854258537,
    0.07681259512901306,
    -0.02744888700544834,
    0.018343262374401093,
    -0.1533321887254715,
    -0.034891266375780106,
    0.04940390586853027,
    -0.03469344973564148,
    0.1144181340932846,
    -0.020629392936825752,
    -0.04379510506987572,
    -0.01248557586222887,
    0.0076397499069571495,
    0.04816306009888649,
    -0.03523264452815056,
    0.03678443282842636,
    0.06143476814031601,
    0.017074264585971832,
    0.019393280148506165,
    -0.015237212181091309,
    -0.004231373313814402,
    0.04593251645565033,
    -0.008326446637511253,
    0.01585036888718605,
    0.05951410531997681,
    -0.009180504828691483,
    -0.014988120645284653,
    -0.06762521713972092,
    -0.07328125089406967,
    -0.03963954746723175,
    -0.07592982798814774,
    0.022783536463975906,
    0.08009243756532669,
    -0.02190149761736393,
    0.016690751537680626,
    3.857908174551437e-33,
    0.09643684327602386,
    0.061698995530605316,
    -0.05794528126716614,
    -0.014153637923300266,
    -0.018940389156341553,
    -0.014195107854902744,
    -0.002279320266097784,
    0.08979488909244537,
    -0.08377993851900101,
    -0.022681940346956253,
    0.06835085898637772,
    -0.030290158465504646,
    0.06811504065990448,
    0.017522336915135384,
    0.04475264996290207,
    0.025644227862358093,
    0.09225139766931534,
    0.047560084611177444,
    -0.07287118583917618,
    0.004113940056413412,
    -0.032728638499975204,
    -0.03421485796570778,
    -0.09297429025173187,
    -0.062267202883958817,
    -0.007878042757511139,
    0.005046974401921034,
    0.015190987847745419,
    0.06858687847852707,
    -0.059300363063812256,
    -0.025944655761122704,
    0.07010263204574585,
    -0.009648559615015984,
    0.011402611620724201,
    0.05207451805472374,
    0.0017910271417349577,
    0.1041133850812912,
    0.01216845866292715,
    -0.073423832654953,
    0.03340119868516922,
    -0.09780909866094589,
    -0.04589647054672241,
    0.027853885665535927,
    -0.019833963364362717,
    0.09239139407873154,
    -0.012382893823087215,
    -0.03981177881360054,
    0.005085271317511797,
    0.0414595901966095,
    -0.08423460274934769,
    0.010074677877128124,
    -0.08320336788892746,
    -0.028330432251095772,
    0.04242296889424324,
    0.004081509541720152,
    -0.045618195086717606,
    0.05454567074775696,
    0.013089517131447792,
    0.059325672686100006,
    0.03164396435022354,
    0.013329800218343735,
    0.01342922542244196,
    0.05420321971178055,
    0.008320336230099201,
    0.08843474090099335,
    0.024797579273581505,
    0.03483450785279274,
    -0.01573028601706028,
    -0.00923924334347248,
    -0.03040337935090065,
    -0.053700175136327744,
    0.04260009527206421,
    -0.009559107944369316,
    0.035370420664548874,
    0.02620706707239151,
    -0.01599731855094433,
    -0.022799722850322723,
    0.011323340237140656,
    0.034805770963430405,
    -0.00011509948672028258,
    0.06145511940121651,
    0.026066437363624573,
    -0.003489985130727291,
    -0.026824232190847397,
    0.043676700443029404,
    0.01968616247177124,
    0.014217364601790905,
    0.04134943708777428,
    0.031210951507091522,
    -0.0029416836332529783,
    -0.05594579875469208,
    0.007755454163998365,
    0.07966292649507523,
    0.07018187642097473,
    -0.05306477099657059,
    0.00865288358181715,
    -1.4480002974437411e-8,
    0.029987109825015068,
    -0.0374179407954216,
    0.06350311636924744,
    0.09183391183614731,
    0.05349404364824295,
    0.05868658050894737,
    -0.02926085889339447,
    -0.01454422902315855,
    -0.031856339424848557,
    0.041788291186094284,
    0.055905237793922424,
    0.03489807993173599,
    -0.03887369856238365,
    -0.05251399800181389,
    0.0535428561270237,
    -0.02301628887653351,
    -0.0296265110373497,
    0.04337646812200546,
    -0.057156164199113846,
    -0.13761606812477112,
    0.03655396029353142,
    0.025227433070540428,
    0.002290866570547223,
    -0.03211537003517151,
    0.007025261875241995,
    -0.0636366605758667,
    -0.035700924694538116,
    -0.0017242596950381994,
    0.011631163768470287,
    -0.06139329820871353,
    -0.013447538018226624,
    0.18389257788658142,
    -0.00769873196259141,
    -0.015793856233358383,
    0.02975468523800373,
    -0.02225983515381813,
    -0.009802130982279778,
    -0.011900249868631363,
    0.06233038753271103,
    -0.025128642097115517,
    -0.04213272035121918,
    -0.05619323253631592,
    -0.04127001017332077,
    -0.03242187201976776,
    -0.015781696885824203,
    0.04642726108431816,
    0.0011592063819989562,
    -0.05414946749806404,
    0.03649138659238815,
    -0.06653305143117905,
    -0.04343418776988983,
    -0.022845521569252014,
    0.054748907685279846,
    0.07311265170574188,
    0.03001636452972889,
    0.06177956610918045,
    0.0161923635751009,
    0.01228793803602457,
    -0.005363925825804472,
    -0.008564196527004242,
    0.1508638709783554,
    0.06815040856599808,
    0.01786571368575096,
    0.011276209726929665
  ]
))
# %%
